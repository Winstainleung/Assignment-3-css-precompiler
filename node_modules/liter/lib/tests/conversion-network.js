"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var index_1 = require("../index");
var chai_1 = require("chai");
require("mocha");
var epsilon = 1e-6;
describe('Conversion network', function () {
    it('should be creatable', function () {
        var net = new index_1.UnitConversionNetwork();
    });
    it('should be loadable with rates', function () {
        var net = new index_1.UnitConversionNetwork();
        net.addRate(42, index_1.Unit.base('thing'), 12, index_1.units.kilogram);
        net.addRate(9, index_1.Unit.base('stuff'), 9, index_1.units.pound);
    });
    it('should fail when adding duplicate rates', function () {
        var net = new index_1.UnitConversionNetwork();
        net.addRate(42, index_1.Unit.base('thing'), 12, index_1.units.kilogram);
        chai_1.expect(function () { return net.addRate(9, index_1.Unit.base('thing'), 9, index_1.units.pound); }).to.throw();
    });
    it('should produce a conversion rate', function () {
        var net = new index_1.UnitConversionNetwork();
        net.addRate(42, index_1.Unit.base('thing'), 12, index_1.units.kilogram);
        net.addRate(1, index_1.Unit.base('stuff'), 9, index_1.units.pound);
        var u = net.getConversionUnit(index_1.Unit.base('thing'), index_1.Unit.base('stuff'));
        if (!u)
            throw new Error('no conversion');
        chai_1.expect(u.termsKey()).to.equal('[0,0,0,0,0,0,0,0,0,"stuff",1,"thing",-1]');
        var c = index_1.q(3.5, index_1.Unit.base('thing')).mul(index_1.q(1, u)).convert(index_1.Unit.base('stuff'));
        chai_1.expect(c.n).to.be.closeTo(1 / 4.082328, epsilon);
    });
    it('should produce all valid conversion rates', function () {
        var net = new index_1.UnitConversionNetwork();
        net.addRate(42, index_1.Unit.base('thing'), 12, index_1.units.kilogram);
        net.addRate(1, index_1.Unit.base('stuff'), 9, index_1.units.pound);
        net.getConversionUnit(index_1.Unit.base('thing'), index_1.Unit.base('stuff'));
        net.getConversionUnit(index_1.Unit.base('stuff'), index_1.Unit.base('thing'));
        net.getConversionUnit(index_1.units.kilogram, index_1.Unit.base('thing'));
        net.getConversionUnit(index_1.units.kilogram, index_1.Unit.base('stuff'));
        net.getConversionUnit(index_1.Unit.base('thing'), index_1.units.kilogram);
        net.getConversionUnit(index_1.Unit.base('stuff'), index_1.units.kilogram);
    });
    it('should fail to convert where no continuity exists', function () {
        var net = new index_1.UnitConversionNetwork();
        net.addRate(42, index_1.Unit.base('thing'), 12, index_1.units.kilogram);
        net.addRate(1, index_1.Unit.base('stuff'), 9, index_1.units.ampere);
        chai_1.expect(net.getConversionUnit(index_1.Unit.base('thing'), index_1.Unit.base('stuff'))).to.not.exist;
        chai_1.expect(net.getConversionUnit(index_1.Unit.base('stuff'), index_1.Unit.base('thing'))).to.not.exist;
        chai_1.expect(net.getConversionUnit(index_1.units.kilogram, index_1.Unit.base('thing'))).to.exist;
        chai_1.expect(net.getConversionUnit(index_1.units.kilogram, index_1.Unit.base('stuff'))).to.not.exist;
        chai_1.expect(net.getConversionUnit(index_1.Unit.base('thing'), index_1.units.kilogram)).to.exist;
        chai_1.expect(net.getConversionUnit(index_1.Unit.base('stuff'), index_1.units.kilogram)).to.not.exist;
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udmVyc2lvbi1uZXR3b3JrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vdGVzdHMvY29udmVyc2lvbi1uZXR3b3JrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsa0NBRWlEO0FBQ2pELDZCQUE4QjtBQUM5QixpQkFBZTtBQUVmLElBQUksT0FBTyxHQUFHLElBQUksQ0FBQztBQUVuQixRQUFRLENBQUMsb0JBQW9CLEVBQUU7SUFDM0IsRUFBRSxDQUFDLHFCQUFxQixFQUFFO1FBQ3RCLElBQUksR0FBRyxHQUFHLElBQUksNkJBQXFCLEVBQUUsQ0FBQztJQUMxQyxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQywrQkFBK0IsRUFBRTtRQUNoQyxJQUFJLEdBQUcsR0FBRyxJQUFJLDZCQUFxQixFQUFFLENBQUM7UUFDdEMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsWUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLEVBQUUsYUFBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3hELEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLFlBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxFQUFFLGFBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN2RCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx5Q0FBeUMsRUFBRTtRQUMxQyxJQUFJLEdBQUcsR0FBRyxJQUFJLDZCQUFxQixFQUFFLENBQUM7UUFDdEMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsWUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLEVBQUUsYUFBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3hELGFBQU0sQ0FBQyxjQUFNLE9BQUEsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsWUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLEVBQUUs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